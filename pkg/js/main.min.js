function newTabPageMain(){function a(a){a.preventDefault(),chrome.tabs.getCurrent(function(b){chrome.tabs.update(b.id,{url:a.target.href})})}function b(a,b){var c=a.innerHTML,d=document.createElement("template");for(var e in b)c=c.replace("{{"+e+"}}",b[e]);return d.innerHTML=c,d.content.cloneNode(!0)}function c(){i=document.getElementById("custom-links"),i.classList.add("is-editing"),e()}function d(){i=document.getElementById("custom-links"),i.classList.remove("is-editing"),i.removeChild(document.getElementById("new-link"))}function e(){i=document.getElementById("custom-links"),i.appendChild(document.getElementById("new-link-template").content.cloneNode(!0)),document.getElementById("new-link-confirm").addEventListener("click",function(){var a=document.getElementById("new-link-title").value,b=document.getElementById("new-link-href").value;f([a,b]),document.getElementById("new-link-title").value="",document.getElementById("new-link-href").value=""})}function f(a){var c=JSON.parse(localStorage.getItem("newtab-custom-links"));c.push(a),localStorage.setItem("newtab-custom-links",JSON.stringify(c));var d=b(p,{title:a[0],href:a[1]});g(d.querySelector(".edit-button.remove")),i.insertBefore(d,document.getElementById("new-link"))}function g(a){var b=function(){i=JSON.parse(localStorage.getItem("newtab-custom-links"));for(var a=this.parentElement.querySelector(".custom-link").innerHTML,b=0;b<i.length;b++)if(i[b][0]==a){console.log(b),i.splice(b,1);break}localStorage.setItem("newtab-custom-links",JSON.stringify(i)),this.parentElement.parentElement.removeChild(this.parentElement)};if(a)a.addEventListener("click",b);else for(var c=document.querySelectorAll("#custom-links .edit-button.remove"),d=0;d<c.length;d++)c[d].addEventListener("click",b)}for(var h=/^chrome:/,i=document.getElementById("custom-links"),j=document.querySelectorAll("a"),k=document.querySelectorAll(".overlay-toggle"),l=document.getElementById("custom-css"),m=document.getElementById("custom-css-field"),n=document.getElementById("edit-links-toggle"),i=JSON.parse(localStorage.getItem("newtab-custom-links"))||[["Twitter","https://twitter.com"],["Facebook","https://www.facebook.com"],["Reddit","http://www.reddit.com"]],o=document.getElementById("custom-links"),p=document.getElementById("custom-link-template"),q=0,r=j.length;r>q;q++)j[q].href.match(h)&&j[q].addEventListener("click",a);for(var q=0,r=k.length;r>q;q++)k[q].addEventListener("click",function(){this.parentElement.classList.toggle("is-active")});document.getElementById("clear-cache").addEventListener("click",function(){this.classList.add("in-progress"),chrome.browsingData.removeCache({},function(){document.getElementById("clear-cache").classList.add("is-complete")})}),document.getElementById("clear-history").addEventListener("click",function(){this.parentElement.classList.toggle("pending-confirm")}),document.getElementById("history-increment").addEventListener("click",function(){var a=["1 day","1 week","1 month","forever","10 minutes"],b=a.indexOf(this.value),c=b!==a.length-1?b+1:0;this.value=a[c]}),document.getElementById("clear-history-confirm").addEventListener("click",function(){var a=document.getElementById("history-increment").value,b=(new Date).getTime(),c=864e5;switch(this.parentElement.classList.remove("pending-confirm"),document.getElementById("clear-history").classList.add("in-progress"),a){case"1 day":a=b-c;break;case"1 week":a=b-7*c;break;case"1 month":a=b-30*c;break;case"forever":a=0;break;case"10 minutes":a=b-6e5}chrome.browsingData.removeHistory({since:a},function(){document.getElementById("clear-history").classList.add("is-complete")})}),l.innerHTML=localStorage.getItem("newtab-custom-css"),m.value=l.innerHTML,m.addEventListener("keyup",function(){document.getElementById("custom-css").innerHTML=this.value,localStorage.setItem("newtab-custom-css",this.value)});for(var q=0,r=i.length;r>q;q++){var s=b(p,{title:i[q][0],href:i[q][1]});o.appendChild(s)}g(),n.addEventListener("click",function(){this.classList.contains("is-active")?(d(),this.classList.remove("is-active"),this.innerHTML="Edit links"):(c(),this.classList.add("is-active"),this.innerHTML="Done editing")})}window.addEventListener("DOMContentLoaded",newTabPageMain);